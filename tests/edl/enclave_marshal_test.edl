enclave {
    from "sgx_tstdc.edl" import 
	sgx_thread_wait_untrusted_event_ocall, 
	sgx_thread_set_untrusted_event_ocall, 
	sgx_thread_setwait_untrusted_events_ocall, 
	sgx_thread_set_multiple_untrusted_events_ocall, 
	sgx_oc_cpuidex;

    trusted {
		/* define ECALLs here. */
		public int enclave_marshal_test_init([out]uint64_t* root_object);		
		public void enclave_marshal_test_destroy();

        public int call(uint64_t object_id, uint64_t interface_id, uint64_t method_id, size_t sz_int, [user_check] const char* data_in, size_t sz_out, [user_check] char* data_out);
        public int try_cast(uint64_t zone_id, uint64_t object_id, uint64_t interface_id);
        public uint64_t add_ref(uint64_t zone_id, uint64_t object_id);
        public uint64_t release(uint64_t zone_id, uint64_t object_id);
    };

    untrusted {
        int call_host(uint64_t object_id, uint64_t interface_id, uint64_t method_id, size_t sz_int, [user_check] const char* data_in, size_t sz_out, [user_check] char* data_out);
        int try_cast_host(uint64_t zone_id, uint64_t object_id, uint64_t interface_id);
        uint64_t add_ref_host(uint64_t zone_id, uint64_t object_id);
        uint64_t release_host(uint64_t zone_id, uint64_t object_id);

        void log_str([in, size=sz] const char* str, size_t sz);
    };
};
